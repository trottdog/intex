<!-- views/public/events-list.ejs -->

<!-- Page Header -->
<section class="section--hero" style="padding-top: 7rem; text-align: center;">
  <div class="container">
    <span class="hero-kicker">Join Us</span>
    <h1>Upcoming Events</h1>
    <p class="text-muted" style="max-width: 600px; margin: 1.5rem auto 0; font-size: var(--text-lg);">
      Discover workshops, performances, summits, and more. Join us as we celebrate 
      culture, build skills, and grow together.
    </p>
  </div>
</section>

<!-- Filter Bar -->
<section class="section--tight">
  <div class="container">
    <div class="filter-bar">
      <div class="filter-group">
        <span class="filter-label">Filter by:</span>
        <div class="filter-pills">
          <a href="/events" class="filter-pill <%= !selectedType ? 'filter-pill--active' : '' %>">
            All Events
          </a>
          <% eventTypes.forEach(type => { %>
            <a href="/events?type=<%= encodeURIComponent(type) %>" 
               class="filter-pill <%= selectedType === type ? 'filter-pill--active' : '' %>">
              <%= type %>
            </a>
          <% }) %>
        </div>
      </div>
      
      <div class="events-count">
        <strong><%= events.length %></strong> event<%= events.length !== 1 ? 's' : '' %>
      </div>
    </div>
  </div>
</section>

<!-- Events Grid -->
<section class="section">
  <div class="container">
    <% if (events.length > 0) { %>
      <div class="events-grid">
        <% events.forEach(event => { %>
          <article class="event-card">
            <a href="/events/<%= event.event_details_id %>" class="event-card-link">
              <div class="event-card-image">
                <% if (event.event_cover_photo) { %>
                  <img src="<%= event.event_cover_photo %>" alt="<%= event.event_name %>" loading="lazy" />
                <% } else { %>
                  <div class="event-card-image-placeholder">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                      <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                      <line x1="16" y1="2" x2="16" y2="6"></line>
                      <line x1="8" y1="2" x2="8" y2="6"></line>
                      <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                  </div>
                <% } %>
                <div class="event-card-date-badge">
                  <span class="date-month"><%= event.event_month || 'TBD' %></span>
                  <span class="date-day"><%= event.event_day || '--' %></span>
                </div>
                <span class="event-card-type"><%= event.event_type || 'Event' %></span>
              </div>
              
              <div class="event-card-body">
                <h3 class="event-card-title"><%= event.event_name %></h3>
                
                <div class="event-card-meta">
                  <div class="meta-item">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <circle cx="12" cy="12" r="10"></circle>
                      <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    <%= event.event_time_start_formatted || 'Time TBD' %>
                  </div>
                  <div class="meta-item">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                      <circle cx="12" cy="10" r="3"></circle>
                    </svg>
                    <%= event.event_location || 'Location TBD' %>
                  </div>
                </div>
                
                <% if (event.event_description_short) { %>
                  <p class="event-card-desc"><%= event.event_description_short %></p>
                <% } %>
                
                <div class="event-card-footer">
                  <% if (event.spots_remaining !== null && event.spots_remaining <= 10) { %>
                    <span class="spots-badge spots-badge--low">
                      <% if (event.spots_remaining === 0) { %>
                        Full
                      <% } else { %>
                        <%= event.spots_remaining %> spot<%= event.spots_remaining !== 1 ? 's' : '' %> left
                      <% } %>
                    </span>
                  <% } else { %>
                    <span class="spots-badge">Open</span>
                  <% } %>
                  <span class="view-details">
                    View Details
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                      <polyline points="12 5 19 12 12 19"></polyline>
                    </svg>
                  </span>
                </div>
              </div>
            </a>
          </article>
        <% }) %>
      </div>
    <% } else { %>
      <div class="empty-state-large">
        <div class="empty-state-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="16" y1="2" x2="16" y2="6"></line>
            <line x1="8" y1="2" x2="8" y2="6"></line>
            <line x1="3" y1="10" x2="21" y2="10"></line>
          </svg>
        </div>
        <h3>No upcoming events</h3>
        <p>
          <% if (selectedType) { %>
            No <%= selectedType %> events scheduled at this time. Check back soon or browse all events.
          <% } else { %>
            We're planning exciting new events! Check back soon or follow us on social media for updates.
          <% } %>
        </p>
        <% if (selectedType) { %>
          <a href="/events" class="btn btn-outline">View All Events</a>
        <% } %>
      </div>
    <% } %>
  </div>
</section>

<!-- CTA Section -->
<section class="section" style="background: var(--color-primary-soft); text-align: center;">
  <div class="container">
    <div style="max-width: 600px; margin: 0 auto;">
      <h2>Want to get involved?</h2>
      <p class="text-muted mt-2 mb-4">
        Whether you're a girl ages 11-18 looking to join our programs, or someone who wants 
        to support our mission, we'd love to hear from you.
      </p>
      <div class="flex-center" style="gap: 1rem; flex-wrap: wrap;">
        <a href="/signup" class="btn btn-primary btn-lg">Enroll Now</a>
        <a href="/donate" class="btn btn-outline btn-lg">Support Us</a>
      </div>
    </div>
  </div>
</section>

<style>
  /* Filter Bar */
  .filter-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
    padding: 1rem 1.5rem;
    background: var(--color-surface);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-soft);
  }
  
  .filter-group {
    display: flex;
    align-items: center;
    gap: 1rem;
  }
  
  .filter-label {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
    font-weight: 500;
  }
  
  .filter-pills {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }
  
  .filter-pill {
    display: inline-block;
    padding: 0.5rem 1rem;
    font-size: var(--text-sm);
    font-weight: 500;
    color: var(--color-text-muted);
    background: var(--color-bg);
    border-radius: var(--radius-pill);
    text-decoration: none;
    transition: all var(--transition-fast);
  }
  
  .filter-pill:hover {
    background: var(--color-primary-soft);
    color: var(--color-text);
  }
  
  .filter-pill--active {
    background: var(--color-primary-dark);
    color: #fff;
  }
  
  .filter-pill--active:hover {
    background: var(--color-primary-dark);
    color: #fff;
  }
  
  .events-count {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
  }
  
  /* Events Grid */
  .events-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
    gap: 1.5rem;
  }
  
  .event-card {
    background: var(--color-surface);
    border-radius: var(--radius-lg);
    overflow: hidden;
    box-shadow: var(--shadow-soft);
    border: 1px solid var(--color-border-subtle);
    transition: all var(--transition-base);
  }
  
  .event-card:hover {
    transform: translateY(-6px);
    box-shadow: var(--shadow-medium);
    border-color: var(--color-primary-soft);
  }
  
  .event-card-link {
    display: block;
    text-decoration: none;
    color: inherit;
  }
  
  .event-card-image {
    position: relative;
    height: 200px;
    background: linear-gradient(135deg, var(--color-primary-soft) 0%, var(--color-dusty-blue) 100%);
    overflow: hidden;
  }
  
  .event-card-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--transition-slow);
  }
  
  .event-card:hover .event-card-image img {
    transform: scale(1.05);
  }
  
  .event-card-image-placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-primary-dark);
    opacity: 0.4;
  }
  
  .event-card-image-placeholder svg {
    width: 64px;
    height: 64px;
  }
  
  .event-card-date-badge {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: var(--color-surface);
    border-radius: var(--radius-md);
    padding: 0.5rem 0.75rem;
    text-align: center;
    box-shadow: var(--shadow-soft);
  }
  
  .date-month {
    display: block;
    font-size: var(--text-xs);
    font-weight: 600;
    text-transform: uppercase;
    color: var(--color-primary-dark);
    line-height: 1;
  }
  
  .date-day {
    display: block;
    font-family: var(--font-heading);
    font-size: var(--text-xl);
    color: var(--color-text);
    line-height: 1.1;
  }
  
  .event-card-type {
    position: absolute;
    top: 1rem;
    left: 1rem;
    padding: 0.3rem 0.75rem;
    background: rgba(58, 63, 59, 0.8);
    backdrop-filter: blur(4px);
    border-radius: var(--radius-pill);
    font-size: var(--text-xs);
    font-weight: 600;
    color: #fff;
  }
  
  .event-card-body {
    padding: 1.5rem;
  }
  
  .event-card-title {
    font-size: var(--text-xl);
    margin: 0 0 0.75rem;
    line-height: 1.3;
  }
  
  .event-card-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-bottom: 0.75rem;
  }
  
  .meta-item {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    font-size: var(--text-sm);
    color: var(--color-text-muted);
  }
  
  .meta-item svg {
    color: var(--color-primary-dark);
  }
  
  .event-card-desc {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
    margin: 0 0 1rem;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    line-height: 1.5;
  }
  
  .event-card-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-top: 1rem;
    border-top: 1px solid var(--color-border-subtle);
  }
  
  .spots-badge {
    font-size: var(--text-xs);
    font-weight: 600;
    padding: 0.25rem 0.6rem;
    background: var(--color-success-soft);
    color: var(--color-accent-dark);
    border-radius: var(--radius-pill);
  }
  
  .spots-badge--low {
    background: rgba(244, 176, 146, 0.2);
    color: #c97a4a;
  }
  
  .view-details {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    font-size: var(--text-sm);
    font-weight: 500;
    color: var(--color-primary-dark);
  }
  
  /* Empty State */
  .empty-state-large {
    text-align: center;
    padding: 5rem 2rem;
    background: var(--color-surface);
    border-radius: var(--radius-lg);
    border: 2px dashed var(--color-border-subtle);
  }
  
  .empty-state-large .empty-state-icon {
    width: 80px;
    height: 80px;
    margin: 0 auto 1.5rem;
    color: var(--color-text-light);
  }
  
  .empty-state-large .empty-state-icon svg {
    width: 100%;
    height: 100%;
  }
  
  .empty-state-large h3 {
    font-size: var(--text-xl);
    margin: 0 0 0.75rem;
  }
  
  .empty-state-large p {
    color: var(--color-text-muted);
    max-width: 450px;
    margin: 0 auto 1.5rem;
  }
  
  /* Responsive */
  @media (max-width: 768px) {
    .filter-bar {
      flex-direction: column;
      align-items: flex-start;
    }
    
    .filter-group {
      flex-direction: column;
      align-items: flex-start;
      width: 100%;
    }
    
    .filter-pills {
      width: 100%;
    }
    
    .events-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
