<!-- views/myJourney/milestones.ejs -->

<section class="section">
  <div class="shell">
    <aside class="sidebar">
      <%- include("../partials/_sidebarMyJourney") %>
    </aside>

    <section>
      <header class="mb-3">
        <h1 class="mt-0">My Milestones</h1>
        <p class="text-muted">
          Track the educational and personal milestones you are working toward,
          from attending workshops to applying for college and beyond.
        </p>
      </header>

      <div class="grid" style="grid-template-columns: repeat(3, minmax(0, 1fr)); gap: 1.5rem;">
        <!-- Planned -->
        <div class="card">
          <h2 class="mt-0" style="font-size: var(--text-lg);">Planned</h2>
          <p class="text-muted" style="font-size: var(--text-sm);">
            Ideas and goals you plan to reach.
          </p>

          <% if (!milestonesPlanned || milestonesPlanned.length === 0) { %>
            <p class="text-muted mt-2" style="font-size: var(--text-sm);">
              No milestones planned yet. You can work with Ella Rises mentors to add some.
            </p>
          <% } else { %>
            <div class="stack mt-2">
              <% milestonesPlanned.forEach(m => { %>
                <article class="card card--hoverable" style="padding: 1rem 1.25rem;">
                  <p class="badge badge--neutral mb-1">
                    <%= m.category || 'Milestone' %>
                  </p>
                  <h3 class="mt-0" style="font-size: var(--text-md);"><%= m.title %></h3>
                  <% if (m.planned_date_formatted) { %>
                    <p class="text-muted" style="font-size: var(--text-xs);">
                      Planned date: <%= m.planned_date_formatted %>
                    </p>
                  <% } %>
                  <% if (m.default_points) { %>
                    <p class="text-muted" style="font-size: var(--text-xs);">
                      Points: <%= m.default_points %>
                    </p>
                  <% } %>
                  <% if (m.notes) { %>
                    <p class="text-muted" style="font-size: var(--text-sm);">
                      <%= m.notes %>
                    </p>
                  <% } %>
                </article>
              <% }) %>
            </div>
          <% } %>
        </div>

        <!-- In progress -->
        <div class="card">
          <h2 class="mt-0" style="font-size: var(--text-lg);">In progress</h2>
          <p class="text-muted" style="font-size: var(--text-sm);">
            Milestones you are actively working on.
          </p>

          <% if (!milestonesInProgress || milestonesInProgress.length === 0) { %>
            <p class="text-muted mt-2" style="font-size: var(--text-sm);">
              When you start on a goal, it will appear here.
            </p>
          <% } else { %>
            <div class="stack mt-2">
              <% milestonesInProgress.forEach(m => { %>
                <article class="card card--hoverable" style="padding: 1rem 1.25rem;">
                  <p class="badge badge--primary mb-1">
                    <%= m.category || 'Milestone' %>
                  </p>
                  <h3 class="mt-0" style="font-size: var(--text-md);"><%= m.title %></h3>
                  <% if (m.planned_date_formatted) { %>
                    <p class="text-muted" style="font-size: var(--text-xs);">
                      Target date: <%= m.planned_date_formatted %>
                    </p>
                  <% } %>
                  <% if (m.progress_notes) { %>
                    <p class="text-muted" style="font-size: var(--text-sm);">
                      <%= m.progress_notes %>
                    </p>
                  <% } %>
                </article>
              <% }) %>
            </div>
          <% } %>
        </div>

        <!-- Achieved -->
        <div class="card">
          <h2 class="mt-0" style="font-size: var(--text-lg);">Achieved</h2>
          <p class="text-muted" style="font-size: var(--text-sm);">
            Milestones you have completed and can celebrate.
          </p>

          <% if (!milestonesAchieved || milestonesAchieved.length === 0) { %>
            <p class="text-muted mt-2" style="font-size: var(--text-sm);">
              Your achieved milestones will appear here. You got this.
            </p>
          <% } else { %>
            <div class="stack mt-2">
              <% milestonesAchieved.forEach(m => { %>
                <article class="card card--hoverable" style="padding: 1rem 1.25rem;">
                  <p class="badge badge--accent mb-1">
                    <%= m.category || 'Milestone' %>
                  </p>
                  <h3 class="mt-0" style="font-size: var(--text-md);"><%= m.title %></h3>
                  <% if (m.achieved_date_formatted) { %>
                    <p class="text-muted" style="font-size: var(--text-xs);">
                      Achieved: <%= m.achieved_date_formatted %>
                    </p>
                  <% } %>
                  <% if (m.default_points) { %>
                    <p class="text-muted" style="font-size: var(--text-xs);">
                      Points earned: <%= m.default_points %>
                    </p>
                  <% } %>
                  <% if (m.notes) { %>
                    <p class="text-muted" style="font-size: var(--text-sm);">
                      <%= m.notes %>
                    </p>
                  <% } %>
                </article>
              <% }) %>
            </div>
          <% } %>
        </div>
      </div>
    </section>
  </div>
</section>
